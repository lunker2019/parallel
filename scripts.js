/* (c) Parallel Project, 2017 */

"use strict";function ready(){function a(){document.querySelector("#body").style.display="block"}function b(b){return b?void d.ref("users/"+b.uid).once("value").then(function(b){g.user=b.toJSON(),a()})["catch"](function(a){console.log(a)}):a()}var c=(firebase.app(),firebase.auth()),d=firebase.database();c.onAuthStateChanged(b);var e={error:null,school:null,country:"United Kingdom",birthYear:2e3,submit:function(a){a.preventDefault(),e.error=null,c.createUserWithEmailAndPassword(e.email,e.password).then(function(a){g.user={first:e.first,last:e.last,birthYear:e.birthYear,country:e.country,gender:e.gender,school:e.school},d.ref("users/"+a.uid).set(g.user)})["catch"](function(a){switch(a.code){case"auth/email-already-in-use":return e.error="There already exists an account with this email address. Please login!";case"auth/invalid-email":return e.error="The email address you provided is invalid.";case"auth/weak-password":return e.error="Please pick a longer password!";default:return e.error="Sorry, we couldn't create your account. Please try again!"}})}},f={error:null,showDropdown:!1,toggleDropdown:function(){f.showDropdown=!f.showDropdown},submit:function(a){a.preventDefault(),f.error=null,c.signInWithEmailAndPassword(f.email,f.password).then(b)["catch"](function(a){switch(a.code){case"auth/invalid-email":return f.error="This email address is invalid.";case"auth/user-not-found":return f.error="There is no account with this email address.";case"auth/wrong-password":return f.error="Incorrect password!";default:return f.error="Sorry, we couldn't log you in. Please try again!"}})}},g=window.app=new Vue({el:"#body",data:{user:null,signup:e,login:f,answers:{},feedback:{},logout:function(){c.signOut().then(function(){g.user=null})}}})}document.addEventListener("DOMContentLoaded",ready),Array.from(window.document.querySelectorAll(".hint")).forEach(function(a){a.addEventListener("click",function(){a.style.height=a.children[0].offsetHeight+"px"})});